"use strict";(self.webpackChunkchat=self.webpackChunkchat||[]).push([[511],{8802:function(e,s,a){a.r(s),a.d(s,{default:function(){return b}});var l=a(5861),i=a(885),n=a(2982),t=a(1413),c=a(7757),r=a.n(c),d=a(2791),o=(a(3925),a(8950)),m=a(9126),v=a(3853),u=a(2426),x=a.n(u),h=a(184),g=function(e){var s,a,l,n=e.activeUser,t=e.sendMessage,c=e.message,r=e.setMessage,u=(0,d.useState)(!1),g=(0,i.Z)(u,2),j=(g[0],g[1],(0,d.useState)(!1)),f=(0,i.Z)(j,2),N=f[0],p=f[1];(0,d.useEffect)((function(){}),[]);return(0,h.jsx)("main",{className:"main is-visible","data-dropzone-area":"",style:{height:"calc(100vh - 40px)"},children:(0,h.jsx)("div",{className:"container h-100",children:(0,h.jsxs)("div",{className:"d-flex flex-column h-100 position-relative",children:[(0,h.jsx)("div",{className:"chat-header py-4 py-lg-7",style:{borderBottom:"1px solid #ddd"},children:(0,h.jsxs)("div",{className:"row align-items-center",children:[(0,h.jsx)("div",{className:"col-2 d-xl-none",children:(0,h.jsx)("a",{className:"icon icon-lg text-muted","data-toggle-chat":""})}),(0,h.jsx)("div",{className:"col-8 col-xl-12",children:(0,h.jsx)("div",{className:"row align-items-center text-center text-xl-start",children:(0,h.jsx)("div",{className:"col-12 col-xl-6",children:(0,h.jsxs)("div",{className:"row align-items-center gx-5",children:[(0,h.jsx)("div",{className:"col-auto",children:(0,h.jsx)("div",{className:"avatar avatar-online",children:(0,h.jsx)("span",{className:"avatar-text bg-primary",children:"J"})})}),(0,h.jsx)("div",{className:"col overflow-hidden",children:(0,h.jsx)("h5",{className:"text-truncate",children:null===n||void 0===n||null===(s=n.user)||void 0===s?void 0:s.name})})]})})})}),(0,h.jsx)("div",{className:"col-2 d-xl-none text-end",children:(0,h.jsx)("a",{className:"icon icon-lg text-muted","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvas-more","aria-controls":"offcanvas-more"})})]})}),(0,h.jsx)("div",{className:"chat-body hide-scrollbar flex-1 h-100",children:(0,h.jsx)("div",{className:"chat-body-inner",style:{paddingBottom:"87px"},children:(0,h.jsx)("div",{className:"py-6 py-lg-12",children:(null===n||void 0===n||null===(a=n.messages)||void 0===a?void 0:a.length)>0&&(null===n||void 0===n||null===(l=n.messages)||void 0===l?void 0:l.map((function(e){var s;return(null===e||void 0===e?void 0:e.from)===(null===n||void 0===n||null===(s=n.user)||void 0===s?void 0:s._id)?(0,h.jsxs)("div",{className:"message",children:[(0,h.jsx)("a",{"data-bs-toggle":"modal","data-bs-target":"#modal-user-profile",className:"avatar avatar-responsive",children:(0,h.jsx)("img",{className:"avatar-img",src:"assets/img/avatars/2.jpg",alt:""})}),(0,h.jsxs)("div",{className:"message-inner",children:[(0,h.jsx)("div",{className:"message-body",children:(0,h.jsx)("div",{className:"message-content",children:(0,h.jsx)("div",{className:"message-text",children:(0,h.jsx)("p",{children:null===e||void 0===e?void 0:e.message})})})}),(0,h.jsx)("div",{className:"message-footer",children:(0,h.jsx)("span",{className:"extra-small text-muted",children:x()(null===e||void 0===e?void 0:e.date).fromNow()})})]})]}):(0,h.jsxs)("div",{className:"message message-out",children:[(0,h.jsx)("a",{"data-bs-toggle":"modal","data-bs-target":"#modal-profile",className:"avatar avatar-responsive",children:(0,h.jsx)("img",{className:"avatar-img",src:"assets/img/avatars/1.jpg",alt:""})}),(0,h.jsxs)("div",{className:"message-inner",children:[(0,h.jsx)("div",{className:"message-body",children:(0,h.jsx)("div",{className:"message-content",children:(0,h.jsx)("div",{className:"message-text",children:(0,h.jsx)("p",{children:null===e||void 0===e?void 0:e.message})})})}),(0,h.jsx)("div",{className:"message-footer",children:(0,h.jsx)("span",{className:"extra-small text-muted",children:x()(null===e||void 0===e?void 0:e.date).fromNow()})})]})]})})))})})}),(0,h.jsxs)("div",{className:"chat-footer pb-3 pb-lg-7 position-absolute bottom-0 start-0",children:[(0,h.jsx)("div",{className:"dz-preview bg-dark",id:"dz-preview-row","data-horizontal-scroll":""}),(0,h.jsx)("form",{className:"chat-form rounded-pill bg-dark","data-emoji-form":"",children:(0,h.jsxs)("div",{className:"row align-items-center gx-0",children:[(0,h.jsx)("div",{className:"col-auto",children:(0,h.jsx)("a",{className:"btn btn-icon text-body rounded-circle dz-clickable",id:"dz-btn",children:(0,h.jsx)(v.UH,{})})}),(0,h.jsx)("div",{className:"col",children:(0,h.jsxs)("div",{className:"input-group",children:[(0,h.jsx)("textarea",{className:"form-control px-0",style:{background:"transparent",border:"none"},placeholder:"Type your message...",rows:"1",onChange:function(e){var s;return r(null===e||void 0===e||null===(s=e.target)||void 0===s?void 0:s.value)},onKeyPress:function(e){"Enter"===e.key&&t()},value:c}),(0,h.jsxs)("a",{className:"text-body pe-0 d-flex align-items-center emoji-section-icon",style:{position:"relative"},children:[(0,h.jsx)(m.yFw,{style:{fontSize:20},onClick:function(){return p(!N)}}),N&&(0,h.jsx)(o.cW,{title:"Plug To Chat",emoji:"",native:!0,onSelect:function(e){"native"in e&&(r("".concat(c).concat(e.native)),p(!1))},style:{position:"absolute",bottom:"35px",right:0,zIndex:9999}})]})]})}),(0,h.jsx)("div",{className:"col-auto",children:(0,h.jsx)("button",{className:"btn btn-icon btn-primary rounded-circle ms-5",onClick:function(){return r()},children:(0,h.jsx)(v.LbG,{})})})]})})]})]})})})},j=function(e){var s=e.users,a=e.setActiveUser,l=e.activeUser;return(0,h.jsx)("aside",{className:"chat-members bg-light",children:(0,h.jsx)("div",{className:"tab-content h-100",children:(0,h.jsx)("div",{className:"tab-pane fade h-100 show active",children:(0,h.jsx)("div",{className:"d-flex flex-column h-100 position-relative",children:(0,h.jsx)("div",{className:"hide-scrollbar",children:(0,h.jsxs)("div",{className:"container py-8",children:[(0,h.jsx)("div",{className:"mb-4",children:(0,h.jsx)("h2",{className:"fw-bold m-0",children:"Chats"})}),(0,h.jsx)("div",{className:"mb-6",children:(0,h.jsx)("form",{action:"#",children:(0,h.jsxs)("div",{className:"input-group",children:[(0,h.jsx)("div",{className:"input-group-text",children:(0,h.jsx)(v.jRj,{style:{fontSize:20}})}),(0,h.jsx)("input",{type:"text",className:"form-control form-control-lg ps-4",placeholder:"Search messages or users","aria-label":"Search for messages or users..."})]})})}),(0,h.jsx)("div",{className:"card-list",children:s.length>0&&s.map((function(e){var s,i,n,t,c;return(0,h.jsx)("a",{className:"card border-0 text-reset",onClick:function(){return a(e)},style:{cursor:"pointer",backgroundColor:(null===l||void 0===l?void 0:l._id)===(null===e||void 0===e?void 0:e._id)?"#f6f6f6":"#fff"},children:(0,h.jsx)("div",{className:"card-body",children:(0,h.jsxs)("div",{className:"row gx-5",children:[(0,h.jsx)("div",{className:"col-auto",children:(0,h.jsx)("div",{className:"avatar avatar-online",children:(0,h.jsx)("span",{className:"avatar-text bg-primary",children:"J"})})}),(0,h.jsxs)("div",{className:"col",children:[(0,h.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,h.jsx)("h5",{className:"me-auto mb-0",children:null===e||void 0===e||null===(s=e.user)||void 0===s?void 0:s.name}),(0,h.jsx)("span",{className:"text-muted extra-small ms-2",children:(null===e||void 0===e||null===(i=e.messages)||void 0===i?void 0:i.length)>0?x()(null===e||void 0===e||null===(n=e.messages[0])||void 0===n?void 0:n.date).fromNow():""})]}),(0,h.jsx)("div",{className:"d-flex align-items-center",children:(0,h.jsx)("div",{className:"line-clamp me-auto",children:(null===e||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.length)>0?null===e||void 0===e||null===(c=e.messages[0])||void 0===c?void 0:c.message:""})})]})]})})},null===e||void 0===e?void 0:e._id)}))})]})})})})})})},f=a(6871),N=a(9566),p=a(2931),b=function(){(0,f.TH)();var e=(0,d.useState)([]),s=(0,i.Z)(e,2),a=s[0],c=s[1],o=(0,d.useState)(""),m=(0,i.Z)(o,2),v=m[0],u=m[1],x=(0,d.useState)(""),b=(0,i.Z)(x,2),y=b[0],w=b[1],k=function(){var e=(0,l.Z)(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.Z.getConvs();case 3:s=e.sent,c(null===s||void 0===s?void 0:s.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),Z=(0,d.useRef)(v);(0,d.useEffect)((function(){Z.current=v}));var _=(0,d.useRef)(a);(0,d.useEffect)((function(){_.current=a})),(0,d.useEffect)((function(){k();var e=function(e){return function(e,s,a,l,i,c){e.some((function(e){return(null===e||void 0===e?void 0:e._id)===(null===i||void 0===i?void 0:i._id)}))?(console.log(l),s(e.map((function(e){return(null===e||void 0===e?void 0:e._id)===(null===i||void 0===i?void 0:i._id)?(0,t.Z)((0,t.Z)({},e),{},{messages:[].concat((0,n.Z)(null===e||void 0===e?void 0:e.messages),[i])}):e}))),""!=l&&(null===l||void 0===l?void 0:l._id)===(null===i||void 0===i?void 0:i._id)&&a((0,t.Z)((0,t.Z)({},l),{},{messages:[].concat((0,n.Z)(null===l||void 0===l?void 0:l.messages),[i])}))):c(),console.log(i,l)}(_.current,c,u,Z.current,e,k)};return p.W.on("message",(function(s){e(s)})),function(){p.W.off("message",e)}}),[]);var C=function(){var e=(0,l.Z)(r().mark((function e(){var s,a,l=arguments;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((s=l.length>0&&void 0!==l[0]?l[0]:null)&&s.preventDefault(),y)try{console.log(v),p.W.emit("sendMessage",{id:null===v||void 0===v?void 0:v._id,to:null===v||void 0===v||null===(a=v.user)||void 0===a?void 0:a._id,message:y}),w("")}catch(i){console.log(i)}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,h.jsxs)("div",{className:"row d-flex m-0",children:[(0,h.jsx)("div",{className:"col-md-4 p-0",children:(0,h.jsx)(j,{users:a,setActiveUser:u,activeUser:v})}),(0,h.jsx)("div",{className:"col-md-8 p-0",children:""!=v&&(0,h.jsx)(g,{sendMessage:C,message:y,setMessage:w,activeUser:v})})]})}}}]);
//# sourceMappingURL=511.74e72ef0.chunk.js.map